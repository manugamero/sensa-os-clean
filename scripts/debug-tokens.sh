#!/bin/bash

echo "ğŸ” Debugging de tokens y autenticaciÃ³n..."
echo ""

echo "ğŸ“‹ Instrucciones para debugging:"
echo ""
echo "1. ğŸŒ Abre http://localhost:3000 en tu navegador"
echo ""
echo "2. ğŸ” Inicia sesiÃ³n con Google si no lo has hecho"
echo ""
echo "3. ğŸ› ï¸ Abre las herramientas de desarrollador (F12)"
echo ""
echo "4. ğŸ“ Ejecuta estos comandos en la consola:"
echo ""
echo "   // Verificar usuario autenticado"
echo "   console.log('Usuario:', firebase.auth().currentUser)"
echo ""
echo "   // Verificar tokens en localStorage"
echo "   console.log('Token:', localStorage.getItem('googleAccessToken'))"
echo "   console.log('Expiry:', localStorage.getItem('googleTokenExpiry'))"
echo ""
echo "   // Verificar si el token ha expirado"
echo "   const expiry = localStorage.getItem('googleTokenExpiry')"
echo "   if (expiry) {"
echo "     console.log('Token expira en:', new Date(parseInt(expiry)))"
echo "     console.log('Â¿Ha expirado?', Date.now() > parseInt(expiry))"
echo "   }"
echo ""
echo "   // Probar obtener token fresco"
echo "   firebase.auth().currentUser?.getIdToken().then(token => {"
echo "     console.log('Token fresco:', token)"
echo "   })"
echo ""
echo "5. ğŸ”„ Si no hay token, cierra sesiÃ³n y vuelve a iniciar sesiÃ³n"
echo ""
echo "6. ğŸš€ Recarga la pÃ¡gina (Ctrl+Shift+R) despuÃ©s de verificar los tokens"
echo ""
echo "ğŸ’¡ Si sigues teniendo problemas:"
echo "   - Limpia el localStorage: localStorage.clear()"
echo "   - Recarga la pÃ¡gina"
echo "   - Inicia sesiÃ³n nuevamente"
